
> fastrack-driving-school-lms@1.0.0 test
> react-scripts test --watchAll=false --bail

PASS src/hooks/useSessionData.test.js
PASS src/hooks/usePVQTrigger.test.js
PASS src/hooks/useBreakManagement.test.js
PASS src/api/errors/__tests__/ApiError.test.js
PASS src/hooks/useSessionTimer.test.js
PASS src/api/base/__tests__/ServiceBase.test.js
PASS src/api/utils/__tests__/validationHelper.test.js
PASS src/services/__tests__/loggingService.test.js
PASS src/api/utils/__tests__/firestoreHelper.test.js
PASS src/api/utils/__tests__/timestampHelper.test.js
PASS src/api/validators/__tests__/sanitizer.test.js
PASS src/api/base/__tests__/QueryHelper.test.js
PASS src/api/base/__tests__/CacheService.test.js
PASS src/api/validators/__tests__/validators.test.js
PASS src/api/enrollment/__tests__/enrollmentServices.concurrent.test.js
PASS src/utils/__tests__/dateTimeFormatter.test.js
PASS src/constants/__tests__/userRoles.assignment.test.js
FAIL src/api/student/__tests__/userServices.getAllStudents.test.js
  â— User Services - getAllStudents â€º should fetch all students with role STUDENT

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

    [0m [90m 40 |[39m     [36mconst[39m result [33m=[39m [36mawait[39m getAllStudents()[33m;[39m
     [90m 41 |[39m
    [31m[1m>[22m[39m[90m 42 |[39m     expect([33mArray[39m[33m.[39misArray(result))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m    |[39m                                   [31m[1m^[22m[39m
     [90m 43 |[39m     expect(result[33m.[39mlength)[33m.[39mtoBe([35m2[39m)[33m;[39m
     [90m 44 |[39m     expect(result[[35m0[39m][33m.[39mrole)[33m.[39mtoBe([33mUSER_ROLES[39m[33m.[39m[33mSTUDENT[39m)[33m;[39m
     [90m 45 |[39m     expect(result[[35m1[39m][33m.[39mrole)[33m.[39mtoBe([33mUSER_ROLES[39m[33m.[39m[33mSTUDENT[39m)[33m;[39m[0m

      at Object.<anonymous> (src/api/student/__tests__/userServices.getAllStudents.test.js:42:35)

  â— User Services - getAllStudents â€º should sort students by displayName

    TypeError: Cannot read properties of undefined (reading '0')

    [0m [90m 73 |[39m     [36mconst[39m result [33m=[39m [36mawait[39m getAllStudents()[33m;[39m
     [90m 74 |[39m
    [31m[1m>[22m[39m[90m 75 |[39m     expect(result[[35m0[39m][33m.[39mdisplayName)[33m.[39mtoBe([32m'Alice'[39m)[33m;[39m
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 76 |[39m     expect(result[[35m1[39m][33m.[39mdisplayName)[33m.[39mtoBe([32m'Zoe'[39m)[33m;[39m
     [90m 77 |[39m   })[33m;[39m
     [90m 78 |[39m[0m

      at Object.<anonymous> (src/api/student/__tests__/userServices.getAllStudents.test.js:75:18)

  â— User Services - getAllStudents â€º should sort by email when displayName is not available

    TypeError: Cannot read properties of undefined (reading '0')

    [0m [90m 104 |[39m     [36mconst[39m result [33m=[39m [36mawait[39m getAllStudents()[33m;[39m
     [90m 105 |[39m
    [31m[1m>[22m[39m[90m 106 |[39m     expect(result[[35m0[39m][33m.[39memail)[33m.[39mtoBe([32m'apple@example.com'[39m)[33m;[39m
     [90m     |[39m                  [31m[1m^[22m[39m
     [90m 107 |[39m     expect(result[[35m1[39m][33m.[39memail)[33m.[39mtoBe([32m'zebra@example.com'[39m)[33m;[39m
     [90m 108 |[39m   })[33m;[39m
     [90m 109 |[39m[0m

      at Object.<anonymous> (src/api/student/__tests__/userServices.getAllStudents.test.js:106:18)

  â— User Services - getAllStudents â€º should return empty array when no students exist

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

    [0m [90m 119 |[39m     [36mconst[39m result [33m=[39m [36mawait[39m getAllStudents()[33m;[39m
     [90m 120 |[39m
    [31m[1m>[22m[39m[90m 121 |[39m     expect([33mArray[39m[33m.[39misArray(result))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m                                   [31m[1m^[22m[39m
     [90m 122 |[39m     expect(result[33m.[39mlength)[33m.[39mtoBe([35m0[39m)[33m;[39m
     [90m 123 |[39m   })[33m;[39m
     [90m 124 |[39m[0m

      at Object.<anonymous> (src/api/student/__tests__/userServices.getAllStudents.test.js:121:35)

  â— User Services - getAllStudents â€º should include all student data fields

    TypeError: Cannot read properties of undefined (reading '0')

    [0m [90m 145 |[39m     [36mconst[39m result [33m=[39m [36mawait[39m getAllStudents()[33m;[39m
     [90m 146 |[39m
    [31m[1m>[22m[39m[90m 147 |[39m     expect(result[[35m0[39m])[33m.[39mtoEqual({
     [90m     |[39m                  [31m[1m^[22m[39m
     [90m 148 |[39m       id[33m:[39m [32m'student-1'[39m[33m,[39m
     [90m 149 |[39m       [33m...[39mmockStudent
     [90m 150 |[39m     })[33m;[39m[0m

      at Object.<anonymous> (src/api/student/__tests__/userServices.getAllStudents.test.js:147:18)

  â— User Services - getAllStudents â€º should use query filter for STUDENT role

    expect(jest.fn()).toHaveBeenCalled()

    Expected number of calls: >= 1
    Received number of calls:    0

    [0m [90m 164 |[39m     [36mawait[39m getAllStudents()[33m;[39m
     [90m 165 |[39m
    [31m[1m>[22m[39m[90m 166 |[39m     expect(firestoreModule[33m.[39mquery)[33m.[39mtoHaveBeenCalled()[33m;[39m
     [90m     |[39m                                   [31m[1m^[22m[39m
     [90m 167 |[39m   })[33m;[39m
     [90m 168 |[39m })[33m;[39m
     [90m 169 |[39m[0m

      at Object.<anonymous> (src/api/student/__tests__/userServices.getAllStudents.test.js:166:35)

Summary of all failing tests
FAIL src/api/student/__tests__/userServices.getAllStudents.test.js
  â— User Services - getAllStudents â€º should fetch all students with role STUDENT

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

    [0m [90m 40 |[39m     [36mconst[39m result [33m=[39m [36mawait[39m getAllStudents()[33m;[39m
     [90m 41 |[39m
    [31m[1m>[22m[39m[90m 42 |[39m     expect([33mArray[39m[33m.[39misArray(result))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m    |[39m                                   [31m[1m^[22m[39m
     [90m 43 |[39m     expect(result[33m.[39mlength)[33m.[39mtoBe([35m2[39m)[33m;[39m
     [90m 44 |[39m     expect(result[[35m0[39m][33m.[39mrole)[33m.[39mtoBe([33mUSER_ROLES[39m[33m.[39m[33mSTUDENT[39m)[33m;[39m
     [90m 45 |[39m     expect(result[[35m1[39m][33m.[39mrole)[33m.[39mtoBe([33mUSER_ROLES[39m[33m.[39m[33mSTUDENT[39m)[33m;[39m[0m

      at Object.<anonymous> (src/api/student/__tests__/userServices.getAllStudents.test.js:42:35)

  â— User Services - getAllStudents â€º should sort students by displayName

    TypeError: Cannot read properties of undefined (reading '0')

    [0m [90m 73 |[39m     [36mconst[39m result [33m=[39m [36mawait[39m getAllStudents()[33m;[39m
     [90m 74 |[39m
    [31m[1m>[22m[39m[90m 75 |[39m     expect(result[[35m0[39m][33m.[39mdisplayName)[33m.[39mtoBe([32m'Alice'[39m)[33m;[39m
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 76 |[39m     expect(result[[35m1[39m][33m.[39mdisplayName)[33m.[39mtoBe([32m'Zoe'[39m)[33m;[39m
     [90m 77 |[39m   })[33m;[39m
     [90m 78 |[39m[0m

      at Object.<anonymous> (src/api/student/__tests__/userServices.getAllStudents.test.js:75:18)

  â— User Services - getAllStudents â€º should sort by email when displayName is not available

    TypeError: Cannot read properties of undefined (reading '0')

    [0m [90m 104 |[39m     [36mconst[39m result [33m=[39m [36mawait[39m getAllStudents()[33m;[39m
     [90m 105 |[39m
    [31m[1m>[22m[39m[90m 106 |[39m     expect(result[[35m0[39m][33m.[39memail)[33m.[39mtoBe([32m'apple@example.com'[39m)[33m;[39m
     [90m     |[39m                  [31m[1m^[22m[39m
     [90m 107 |[39m     expect(result[[35m1[39m][33m.[39memail)[33m.[39mtoBe([32m'zebra@example.com'[39m)[33m;[39m
     [90m 108 |[39m   })[33m;[39m
     [90m 109 |[39m[0m

      at Object.<anonymous> (src/api/student/__tests__/userServices.getAllStudents.test.js:106:18)

  â— User Services - getAllStudents â€º should return empty array when no students exist

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

    [0m [90m 119 |[39m     [36mconst[39m result [33m=[39m [36mawait[39m getAllStudents()[33m;[39m
     [90m 120 |[39m
    [31m[1m>[22m[39m[90m 121 |[39m     expect([33mArray[39m[33m.[39misArray(result))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m                                   [31m[1m^[22m[39m
     [90m 122 |[39m     expect(result[33m.[39mlength)[33m.[39mtoBe([35m0[39m)[33m;[39m
     [90m 123 |[39m   })[33m;[39m
     [90m 124 |[39m[0m

      at Object.<anonymous> (src/api/student/__tests__/userServices.getAllStudents.test.js:121:35)

  â— User Services - getAllStudents â€º should include all student data fields

    TypeError: Cannot read properties of undefined (reading '0')

    [0m [90m 145 |[39m     [36mconst[39m result [33m=[39m [36mawait[39m getAllStudents()[33m;[39m
     [90m 146 |[39m
    [31m[1m>[22m[39m[90m 147 |[39m     expect(result[[35m0[39m])[33m.[39mtoEqual({
     [90m     |[39m                  [31m[1m^[22m[39m
     [90m 148 |[39m       id[33m:[39m [32m'student-1'[39m[33m,[39m
     [90m 149 |[39m       [33m...[39mmockStudent
     [90m 150 |[39m     })[33m;[39m[0m

      at Object.<anonymous> (src/api/student/__tests__/userServices.getAllStudents.test.js:147:18)

  â— User Services - getAllStudents â€º should use query filter for STUDENT role

    expect(jest.fn()).toHaveBeenCalled()

    Expected number of calls: >= 1
    Received number of calls:    0

    [0m [90m 164 |[39m     [36mawait[39m getAllStudents()[33m;[39m
     [90m 165 |[39m
    [31m[1m>[22m[39m[90m 166 |[39m     expect(firestoreModule[33m.[39mquery)[33m.[39mtoHaveBeenCalled()[33m;[39m
     [90m     |[39m                                   [31m[1m^[22m[39m
     [90m 167 |[39m   })[33m;[39m
     [90m 168 |[39m })[33m;[39m
     [90m 169 |[39m[0m

      at Object.<anonymous> (src/api/student/__tests__/userServices.getAllStudents.test.js:166:35)


Test Suites: 1 failed, 17 passed, 18 of 27 total
Tests:       6 failed, 603 passed, 609 total
Snapshots:   0 total
Time:        4.013 s
Ran all test suites.
